{
  "$schema": "https://opencode.ai/config.json",
  
  "model": "anthropic/claude-sonnet-4",
  "autoupdate": true,
  
  "mcp": {
    "notion": {
      "type": "remote",
      "url": "https://mcp.notion.com/mcp",
      "enabled": false,
      "timeout": 10000,
      "description": "Notion hosted MCP server with OAuth 2.0 authentication. Connect via OAuth flow - no API key needed."
    },
    "playwright": {
      "type": "local",
      "command": ["npx", "-y", "@modelcontextprotocol/server-playwright"],
      "enabled": true,
      "timeout": 15000
    },
    "youtube": {
      "type": "local",
      "command": ["npx", "-y", "@modelcontextprotocol/server-youtube"],
      "enabled": false,
      "environment": {
        "YOUTUBE_API_KEY": "${YOUTUBE_API_KEY}"
      },
      "timeout": 10000,
      "description": "YouTube MCP server. Can use API key or Google OAuth. For OAuth, use Google Cloud OAuth credentials."
    },
    "github": {
      "type": "local",
      "command": ["npx", "-y", "@modelcontextprotocol/server-github"],
      "enabled": false,
      "environment": {
        "GITHUB_PERSONAL_ACCESS_TOKEN": "${GITHUB_TOKEN}"
      },
      "timeout": 10000,
      "description": "GitHub MCP server. Supports OAuth 2.0 - register OAuth app and use client credentials."
    },
    "google-drive": {
      "type": "local",
      "command": ["npx", "-y", "@modelcontextprotocol/server-google-drive"],
      "enabled": false,
      "environment": {
        "GOOGLE_DRIVE_CREDENTIALS_PATH": "${GOOGLE_DRIVE_CREDENTIALS_PATH}",
        "GCP_OAUTH_KEYS_PATH": "${GCP_OAUTH_KEYS_PATH:-gcp-oauth.keys.json}"
      },
      "timeout": 10000,
      "description": "Google Drive MCP server with OAuth 2.0. Requires gcp-oauth.keys.json file. Run 'node ./dist auth' after setup."
    },
    "slack": {
      "type": "local",
      "command": ["npx", "-y", "@modelcontextprotocol/server-slack"],
      "enabled": false,
      "environment": {
        "SLACK_BOT_TOKEN": "${SLACK_BOT_TOKEN}",
        "SLACK_TEAM_ID": "${SLACK_TEAM_ID}"
      },
      "timeout": 10000
    },
    "brave-search": {
      "type": "local",
      "command": ["npx", "-y", "@modelcontextprotocol/server-brave-search"],
      "enabled": false,
      "environment": {
        "BRAVE_API_KEY": "${BRAVE_API_KEY}"
      },
      "timeout": 10000
    },
    "filesystem": {
      "type": "local",
      "command": ["npx", "-y", "@modelcontextprotocol/server-filesystem"],
      "enabled": true,
      "environment": {
        "ALLOWED_DIRECTORIES": "${PWD}"
      },
      "timeout": 5000
    },
    "postgres": {
      "type": "local",
      "command": ["npx", "-y", "@modelcontextprotocol/server-postgres"],
      "enabled": false,
      "environment": {
        "POSTGRES_CONNECTION_STRING": "${POSTGRES_CONNECTION_STRING}"
      },
      "timeout": 10000
    },
    "sqlite": {
      "type": "local",
      "command": ["npx", "-y", "@modelcontextprotocol/server-sqlite"],
      "enabled": false,
      "environment": {
        "SQLITE_DB_PATH": "${SQLITE_DB_PATH}"
      },
      "timeout": 5000
    },
    "puppeteer": {
      "type": "local",
      "command": ["npx", "-y", "@modelcontextprotocol/server-puppeteer"],
      "enabled": false,
      "timeout": 15000
    },
    "git": {
      "type": "local",
      "command": ["npx", "-y", "@modelcontextprotocol/server-git"],
      "enabled": true,
      "timeout": 5000
    },
    "memory": {
      "type": "local",
      "command": ["npx", "-y", "@modelcontextprotocol/server-memory"],
      "enabled": true,
      "timeout": 5000
    }
  },
  
  "agent": {
    "primary": {
      "description": "Primary agent for DevSecOps Tech Blog - Sisyphus mode with Ralph Loop support (High-quality for code/content work)",
      "mode": "primary",
      "model": "anthropic/claude-opus-4-5",
      "temperature": 0.3,
      "maxSteps": 50,
      "tools": {
        "write": true,
        "edit": true,
        "bash": true
      },
      "permission": {
        "edit": "allow",
        "bash": "allow"
      }
    },
    "explore": {
      "description": "Exploration agent for codebase analysis and discovery (Cost-optimized, read-only)",
      "mode": "subagent",
      "model": "anthropic/claude-sonnet-4",
      "temperature": 0.2,
      "maxSteps": 20,
      "tools": {
        "write": false,
        "edit": false,
        "bash": false
      },
      "permission": {
        "edit": "deny",
        "bash": "deny"
      }
    },
    "validate": {
      "description": "Validation agent for quality checks and security audits (Cost-optimized, rule-based)",
      "mode": "subagent",
      "model": "anthropic/claude-sonnet-4",
      "temperature": 0.1,
      "maxSteps": 10,
      "tools": {
        "write": false,
        "edit": false,
        "bash": false
      },
      "permission": {
        "edit": "deny",
        "bash": "deny"
      }
    },
    "code": {
      "description": "Code-focused agent for complex coding tasks (High-quality model)",
      "mode": "subagent",
      "model": "anthropic/claude-opus-4-5",
      "temperature": 0.2,
      "maxSteps": 30,
      "tools": {
        "write": true,
        "edit": true,
        "bash": true
      },
      "permission": {
        "edit": "allow",
        "bash": "ask"
      }
    }
  },
  
  "command": {
    "improve-posts": {
      "description": "Ralph Loop: Continuously improve blog posts from RSS news (Sisyphus mode) - High-quality model for content generation",
      "template": "You are improving blog posts using the Ralph Loop pattern. Follow the workflow in .opencode/commands/improve-posts.md. CRITICAL: 1) Check cache first (_data/collected_news.json, 7-day TTL), 2) Use local scripts (python3 scripts/*.py) before any API calls, 3) Prioritize Gemini CLI (free) over paid APIs, 4) Batch operations to reduce API calls, 5) Mask sensitive data in logs. Output <promise>POSTS_IMPROVED</promise> when complete.",
      "agent": "primary",
      "model": "anthropic/claude-opus-4-5"
    },
    "collect-news": {
      "description": "Collect tech/security news from RSS feeds (Cost-optimized with caching)",
      "template": "CRITICAL COST OPTIMIZATION: 1) Check _data/collected_news.json cache first (use if < 7 days old), 2) Use python3 scripts/collect_tech_news.py (local script, no API cost), 3) Rate limit: max 15 requests/minute, 4) Batch all feeds in single run, 5) Never use paid APIs for this task. Output <promise>NEWS_COLLECTED</promise> when complete.",
      "agent": "explore",
      "model": "anthropic/claude-sonnet-4"
    },
    "validate-posts": {
      "description": "Validate all posts for quality and security compliance (Cost-optimized validation)",
      "template": "SECURITY & VALIDATION: Run validation scripts in order: 1) python3 scripts/check_posts.py (quality), 2) python3 scripts/fix_links_unified.py --check (links), 3) python3 scripts/verify_images_unified.py --all (images). SECURITY CHECKS: Check for hardcoded secrets, validate file permissions, check for XSS/injection patterns, ensure English-only image filenames. Never expose sensitive information. Output <promise>POSTS_VALIDATED</promise> when complete.",
      "agent": "validate",
      "model": "anthropic/claude-sonnet-4"
    },
    "generate-images": {
      "description": "Generate missing post images (English filenames only) - High-quality for image generation",
      "template": "Generate post images using python3 scripts/generate_post_images.py --all. CRITICAL: 1) All filenames must be English only (no Korean), 2) Format: YYYY-MM-DD-English_Title.svg, 3) SVG content must be English only, 4) Validate before saving, 5) Use local scripts, avoid API calls. Output <promise>IMAGES_GENERATED</promise> when complete.",
      "agent": "primary",
      "model": "anthropic/claude-opus-4-5"
    },
    "security-audit": {
      "description": "Security audit: check for secrets, validate inputs, review permissions (Cost-optimized)",
      "template": "COMPREHENSIVE SECURITY AUDIT: 1) Scan for hardcoded secrets (API keys, passwords, tokens), 2) Validate file permissions (check .env, config files), 3) Review API usage patterns (rate limiting, authentication), 4) Check for XSS/injection patterns in code, 5) Validate input sanitization, 6) Check for exposed sensitive data in logs. Use scripts/check_security.py if available. NEVER expose sensitive information in output. Output security report with masked sensitive data. Output <promise>SECURITY_AUDIT_COMPLETE</promise> when done.",
      "agent": "validate",
      "model": "anthropic/claude-sonnet-4"
    },
    "cost-optimize": {
      "description": "Optimize API usage and costs - analyze and recommend optimizations",
      "template": "COST OPTIMIZATION ANALYSIS: Review API usage patterns and recommend optimizations. PRIORITY ORDER: 1) Gemini CLI (OAuth 2.0, free) ‚≠ê First Choice, 2) Local templates/scripts (no cost), 3) Cursor/Claude Console (free allocation), 4) API calls (minimize, use caching). Check: cache usage (7-day TTL), rate limiting compliance, batch processing opportunities, prompt caching usage. Generate optimization report. Output <promise>COST_OPTIMIZED</promise> when complete.",
      "agent": "explore",
      "model": "anthropic/claude-sonnet-4"
    },
    "write-code": {
      "description": "Write or refactor code (High-quality model for complex coding)",
      "template": "Write high-quality code following best practices. SECURITY: 1) Never hardcode secrets (use env vars), 2) Validate all inputs, 3) Sanitize outputs, 4) Follow principle of least privilege. COST: Use local tools when possible, minimize API calls. QUALITY: Add type hints, docstrings, error handling, tests. Output <promise>CODE_WRITTEN</promise> when complete.",
      "agent": "code",
      "model": "anthropic/claude-opus-4-5"
    },
    "refactor": {
      "description": "Refactor existing code (High-quality model for code improvement)",
      "template": "Refactor code for better maintainability, performance, and security. SECURITY: Review for vulnerabilities, validate inputs, check permissions. COST: Optimize API usage, use caching. QUALITY: Improve structure, add tests, update documentation. Output <promise>CODE_REFACTORED</promise> when complete.",
      "agent": "code",
      "model": "anthropic/claude-opus-4-5"
    },
    "fix-bugs": {
      "description": "Fix bugs and security issues (High-quality model for debugging)",
      "template": "Fix bugs and security issues. SECURITY: 1) Check for injection vulnerabilities, 2) Validate inputs, 3) Check error handling, 4) Review permissions. COST: Use local debugging tools first. QUALITY: Add tests, update documentation. Output <promise>BUGS_FIXED</promise> when complete.",
      "agent": "code",
      "model": "anthropic/claude-opus-4-5"
    }
  }
}
