---
layout: post
title: "클라우드 시큐리티 과정 7기 - 3주차: AWS 보안 및 FinOps"
date: 2025-05-02 00:41:54 +0900
category: cloud
tags: [AWS, FinOps, Cloud-Security, Cost-Optimization, Well-Architected]
excerpt: "클라우드 보안 과정 7기 3주차에서 다룬 AWS 보안 및 FinOps, 아키텍처 심화 내용을 정리했습니다. AWS 환경에서의 보안 강화 및 아키텍처 최적화, 실무에 바로 적용 가능한 FinOps 전략을 다룹니다."
comments: true
toc: true
original_url: https://twodragon.tistory.com/679
image: /assets/images/2025-05-02-클라우드_시큐리티_과정_7기_-_3주차_AWS_보안_및_Finops.svg
---

<div class="ai-summary-card">
<div class="ai-summary-header">
  <span class="ai-badge">AI 요약</span>
</div>
<div class="ai-summary-content">
  <div class="summary-row">
    <span class="summary-label">제목</span>
    <span class="summary-value">클라우드 시큐리티 과정 7기 - 3주차: AWS 보안 및 FinOps</span>
  </div>
  <div class="summary-row">
    <span class="summary-label">카테고리</span>
    <span class="summary-value"><span class="category-tag cloud">Cloud</span></span>
  </div>
  <div class="summary-row">
    <span class="summary-label">태그</span>
    <span class="summary-value tags">
      <span class="tag">AWS</span>
      <span class="tag">FinOps</span>
      <span class="tag">Cloud-Security</span>
      <span class="tag">Cost-Optimization</span>
      <span class="tag">Well-Architected</span>
    </span>
  </div>
  <div class="summary-row highlights">
    <span class="summary-label">핵심 내용</span>
    <ul class="summary-list">
      <li>AWS 보안 서비스 전체 구조 및 IAM 보안 모범 사례</li>
      <li>FinOps 프레임워크 및 비용 최적화 전략</li>
      <li>AWS 환경에서의 보안 강화 및 아키텍처 최적화</li>
    </ul>
  </div>
  <div class="summary-row">
    <span class="summary-label">기술/도구</span>
    <span class="summary-value">AWS, FinOps, GuardDuty, Security Hub</span>
  </div>
  <div class="summary-row">
    <span class="summary-label">대상 독자</span>
    <span class="summary-value">클라우드 아키텍트, DevOps 엔지니어, 클라우드 관리자</span>
  </div>
</div>
<div class="ai-summary-footer">
  이 포스팅은 AI가 쉽게 이해하고 활용할 수 있도록 구조화된 요약을 포함합니다.
</div>
</div>



<img src="{{ '/assets/images/2025-05-02-클라우드_시큐리티_과정_7기_-_3주차_AWS_보안_및_Finops_image.png' | relative_url }}" alt="포스트 이미지" loading="lazy" class="post-image">
*그림: 포스트 이미지*


## 1. AWS 보안 아키텍처

### 1.1 AWS 보안 서비스 전체 구조

```
┌─────────────────────────────────────────────────────────────────────────┐
│                        AWS Security Services                             │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐    │
│  │   IAM       │  │ AWS         │  │ CloudTrail  │  │ AWS         │    │
│  │ Identity    │  │ Organizations│  │ (Audit)     │  │ Config      │    │
│  │ Center      │  │ (SCP)       │  │             │  │ (Rules)     │    │
│  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘    │
│                                                                          │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │                    Security Hub (중앙 집중 보안)                   │    │
│  │  ┌───────────┐  ┌───────────┐  ┌───────────┐  ┌───────────┐     │    │
│  │  │ GuardDuty │  │ Inspector │  │  Macie    │  │ Detective │     │    │
│  │  │ (Threat)  │  │ (Vuln)    │  │ (Data)    │  │ (Forensic)│     │    │
│  │  └───────────┘  └───────────┘  └───────────┘  └───────────┘     │    │
│  └─────────────────────────────────────────────────────────────────┘    │
│                                                                          │
│  ┌─────────────────────────────────┐  ┌────────────────────────────┐   │
│  │      Network Security           │  │      Data Protection       │   │
│  │  ┌───────┐ ┌───────┐ ┌───────┐ │  │  ┌───────┐  ┌───────────┐  │   │
│  │  │  WAF  │ │Shield │ │Firewall│ │  │  │  KMS  │  │ Secrets   │  │   │
│  │  │       │ │ Adv   │ │Manager │ │  │  │       │  │ Manager   │  │   │
│  │  └───────┘ └───────┘ └───────┘ │  │  └───────┘  └───────────┘  │   │
│  └─────────────────────────────────┘  └────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────────────┘
```

### 1.2 IAM 보안 모범 사례

```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "AllowS3ReadOnly",
      "Effect": "Allow",
      "Action": [
        "s3:GetObject",
        "s3:ListBucket"
      ],
      "Resource": [
        "arn:aws:s3:::my-bucket",
        "arn:aws:s3:::my-bucket/*"
      ],
      "Condition": {
        "IpAddress": {
          "aws:SourceIp": ["10.0.0.0/8"]
        },
        "Bool": {
          "aws:MultiFactorAuthPresent": "true"
        }
      }
    }
  ]
}
```

### 1.3 VPC 보안 구성

```hcl
# Terraform: 보안 VPC 구성
resource "aws_vpc" "secure_vpc" {
  cidr_block           = "10.0.0.0/16"
  enable_dns_hostnames = true
  enable_dns_support   = true

  tags = {
    Name = "secure-vpc"
  }
}

# Security Group: Web 서버
resource "aws_security_group" "web" {
  name        = "web-sg"
  description = "Security group for web servers"
  vpc_id      = aws_vpc.secure_vpc.id

  ingress {
    description     = "HTTPS from ALB"
    from_port       = 443
    to_port         = 443
    protocol        = "tcp"
    security_groups = [aws_security_group.alb.id]
  }

  egress {
    description     = "Outbound to DB"
    from_port       = 5432
    to_port         = 5432
    protocol        = "tcp"
    security_groups = [aws_security_group.db.id]
  }
}

# VPC Flow Logs
resource "aws_flow_log" "main" {
  iam_role_arn    = aws_iam_role.flow_log.arn
  log_destination = aws_cloudwatch_log_group.flow_log.arn
  traffic_type    = "ALL"
  vpc_id          = aws_vpc.secure_vpc.id
}
```

## 2. AWS 보안 서비스 상세

### 2.1 GuardDuty 자동화 대응

```python
import boto3
import json

def lambda_handler(event, context):
    """GuardDuty 위협 자동 대응"""
    detail = event['detail']
    finding_type = detail['type']
    severity = detail['severity']

    if severity >= 7:  # HIGH
        handle_high_severity(detail)
    elif severity >= 4:  # MEDIUM
        handle_medium_severity(detail)

    return {'statusCode': 200}

def handle_high_severity(detail):
    """심각도 높은 위협 대응"""
    ec2 = boto3.client('ec2')
    sns = boto3.client('sns')

    if 'Resource' in detail:
        resource = detail['Resource']
        if resource.get('ResourceType') == 'Instance':
            instance_id = resource['InstanceDetails']['InstanceId']

            # 격리 보안그룹으로 변경
            ec2.modify_instance_attribute(
                InstanceId=instance_id,
                Groups=['sg-isolation']
            )

    # 알림 발송
    sns.publish(
        TopicArn='arn:aws:sns:ap-northeast-2:123456789:security-alerts',
        Subject=f"[CRITICAL] GuardDuty Alert: {detail['type']}",
        Message=json.dumps(detail, indent=2)
    )
```

## 3. FinOps 전략

### 3.1 FinOps 프레임워크

```
┌─────────────────────────────────────────────────────────────────┐
│                    FinOps Lifecycle                              │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│     ┌─────────────┐                                             │
│     │   Inform    │◄──────────────────────────┐                 │
│     │ (가시성확보) │                           │                 │
│     └──────┬──────┘                           │                 │
│            │                                   │                 │
│            ▼                                   │                 │
│     ┌─────────────┐                           │                 │
│     │  Optimize   │                           │                 │
│     │ (비용최적화) │                           │                 │
│     └──────┬──────┘                           │                 │
│            │                                   │                 │
│            ▼                                   │                 │
│     ┌─────────────┐                           │                 │
│     │   Operate   │───────────────────────────┘                 │
│     │  (운영관리)  │                                             │
│     └─────────────┘                                             │
│                                                                  │
│  Capabilities:                                                   │
│  ├── Cost Allocation & Tagging                                  │
│  ├── Budgeting & Forecasting                                    │
│  ├── Anomaly Detection                                          │
│  ├── Reserved Instance / Savings Plans                          │
│  └── Right Sizing                                               │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 3.2 비용 태깅 전략

```json
{
  "tags": {
    "Environment": {
      "required": true,
      "allowed_values": ["Production", "Staging", "Development", "Test"]
    },
    "Project": {
      "required": true,
      "pattern": "^[A-Z]{2,4}-[0-9]{4}$"
    },
    "Owner": {
      "required": true,
      "pattern": "^[a-z]+@company\\.com$"
    },
    "CostCenter": {
      "required": true,
      "pattern": "^CC-[0-9]{5}$"
    }
  }
}
```

### 3.3 AWS Cost Explorer API 활용

```python
import boto3
from datetime import datetime, timedelta

def analyze_costs():
    """월간 비용 분석 및 이상 탐지"""
    ce = boto3.client('ce')

    end = datetime.now()
    start = end - timedelta(days=30)

    response = ce.get_cost_and_usage(
        TimePeriod={
            'Start': start.strftime('%Y-%m-%d'),
            'End': end.strftime('%Y-%m-%d')
        },
        Granularity='DAILY',
        Metrics=['UnblendedCost'],
        GroupBy=[
            {'Type': 'DIMENSION', 'Key': 'SERVICE'},
            {'Type': 'TAG', 'Key': 'Environment'}
        ]
    )

    return response
```

### 3.4 비용 알림 설정

```python
import boto3

def create_budget_alerts():
    """예산 및 알림 생성"""
    budgets = boto3.client('budgets')
    account_id = boto3.client('sts').get_caller_identity()['Account']

    budgets.create_budget(
        AccountId=account_id,
        Budget={
            'BudgetName': 'Monthly-Production-Budget',
            'BudgetLimit': {
                'Amount': '10000',
                'Unit': 'USD'
            },
            'CostFilters': {
                'TagKeyValue': ['user:Environment$Production']
            },
            'TimeUnit': 'MONTHLY',
            'BudgetType': 'COST'
        },
        NotificationsWithSubscribers=[
            {
                'Notification': {
                    'NotificationType': 'ACTUAL',
                    'ComparisonOperator': 'GREATER_THAN',
                    'Threshold': 80,
                    'ThresholdType': 'PERCENTAGE'
                },
                'Subscribers': [
                    {
                        'SubscriptionType': 'EMAIL',
                        'Address': 'finops@company.com'
                    }
                ]
            }
        ]
    )
```

## 4. 비용 최적화 실전 가이드

### 4.1 EC2 Right Sizing

```bash
# AWS Compute Optimizer 활용
aws compute-optimizer get-ec2-instance-recommendations \
  --filters name=Finding,values=OVER_PROVISIONED \
  --query 'instanceRecommendations[*].{
    InstanceId: instanceArn,
    CurrentType: currentInstanceType,
    RecommendedType: recommendationOptions[0].instanceType,
    EstimatedSavings: recommendationOptions[0].estimatedMonthlySavings.value
  }' \
  --output table
```

### 4.2 Savings Plans 전략

```yaml
compute_savings_plan:
  type: "Compute Savings Plans"
  term: "1 Year"
  payment_option: "Partial Upfront"
  commitment: "$1000/hour"

  coverage_strategy:
    - priority: 1
      workload: "Baseline Production"
      coverage: 80%
    - priority: 2
      workload: "Development/Test"
      coverage: 0%  # On-Demand 유지
```

## 5. FinOps 대시보드 KPI

| 지표 | 설명 | 목표 |
|------|------|------|
| **Unit Cost** | 트랜잭션당 비용 | 감소 추세 |
| **Coverage** | RI/SP 커버리지 | > 70% |
| **Utilization** | RI/SP 활용률 | > 80% |
| **Waste Rate** | 미사용 리소스 비율 | < 5% |
| **Tagging Compliance** | 태그 준수율 | > 95% |

## 6. 마무리

이번 주차에서는 AWS 보안 서비스의 통합 활용과 FinOps 전략을 학습했습니다. 보안과 비용 최적화는 상충되는 것이 아니라, **Well-Architected Framework**를 통해 함께 달성할 수 있습니다.

> **다음 주차 예고:** AWS 취약점 점검 및 ISMS-P 대응 가이드

---

📚 **참고 자료:**
- [AWS Well-Architected Framework](https://aws.amazon.com/architecture/well-architected/)
- [AWS Security Best Practices](https://docs.aws.amazon.com/security/)
- [FinOps Foundation](https://www.finops.org/)
