# Pipeline Architecture

> tech-blog 프로젝트 전체 아키텍처 상세

## 시스템 아키텍처

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           TECH-BLOG ARCHITECTURE                             │
└─────────────────────────────────────────────────────────────────────────────┘

                                   DEVELOPER
                                      │
                                      ▼
                              ┌───────────────┐
                              │   Local Dev   │
                              │   Environment │
                              │               │
                              │ • Jekyll      │
                              │ • Node.js     │
                              │ • Python      │
                              │ • Cursor/VS   │
                              └───────┬───────┘
                                      │
                                      │ git push
                                      ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                              GITHUB REPOSITORY                               │
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │                              main branch                             │   │
│   │                                                                      │   │
│   │   _posts/          _layouts/        assets/           scripts/      │   │
│   │   _includes/       _sass/           _config.yml       docs/         │   │
│   │                                                                      │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │                           GitHub Actions                             │   │
│   │                                                                      │   │
│   │   ┌─────────────┐    ┌─────────────┐    ┌─────────────┐            │   │
│   │   │ jekyll.yml  │    │sns-share.yml│    │buttondown.  │            │   │
│   │   │             │    │             │    │ yml         │            │   │
│   │   │ Build→      │    │ Share to    │    │ Email       │            │   │
│   │   │ Deploy      │    │ SNS         │    │ Newsletter  │            │   │
│   │   └──────┬──────┘    └──────┬──────┘    └──────┬──────┘            │   │
│   │          │                  │                  │                    │   │
│   └──────────┼──────────────────┼──────────────────┼────────────────────┘   │
│              │                  │                  │                        │
└──────────────┼──────────────────┼──────────────────┼────────────────────────┘
               │                  │                  │
               │                  │                  │
       ┌───────┴───────┐  ┌───────┴───────┐  ┌───────┴───────┐
       │               │  │               │  │               │
       ▼               ▼  ▼               ▼  ▼               ▼
┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐
│   GitHub    │ │   Vercel    │ │    SNS      │ │  Buttondown │
│   Pages     │ │             │ │  Platforms  │ │             │
│             │ │ CDN Edge    │ │             │ │ Newsletter  │
│ (Backup)    │ │ (Primary)   │ │ X/FB/LI     │ │ Service     │
└──────┬──────┘ └──────┬──────┘ └──────┬──────┘ └──────┬──────┘
       │               │               │               │
       └───────────────┴───────────────┴───────────────┘
                              │
                              ▼
                        ┌───────────────┐
                        │     USERS     │
                        │               │
                        │ • Web访问    │
                        │ • RSS订阅    │
                        │ • Newsletter  │
                        │ • SNS Follow  │
                        └───────────────┘
```

## 기술 스택

### Core

| 기술 | 버전 | 용도 |
|------|------|------|
| Jekyll | 4.3.x | 정적 사이트 생성기 |
| Ruby | 3.3 | Jekyll 런타임 |
| Node.js | 20 | 빌드 도구 |
| Python | 3.11 | 자동화 스크립트 |

### Hosting & CDN

| 서비스 | 용도 | 비용 |
|--------|------|------|
| Vercel | Primary 호스팅 | Free |
| GitHub Pages | Backup 호스팅 | Free |
| Cloudflare | (선택) DNS/CDN | Free |

### CI/CD

| 서비스 | 용도 | 비용 |
|--------|------|------|
| GitHub Actions | CI/CD 파이프라인 | Free (2,000분/월) |
| Vercel CI | Auto-deploy | Free |

### External Services

| 서비스 | 용도 | 비용 |
|--------|------|------|
| Sentry | 에러 추적 | Free (5,000 이벤트/월) |
| Buttondown | 뉴스레터 | Free (100 구독자) |
| Giscus | 댓글 | Free |
| Gemini API | AI 이미지 | Free Tier |

## 데이터 흐름

### 포스트 발행 흐름

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           POST PUBLISHING FLOW                               │
└─────────────────────────────────────────────────────────────────────────────┘

1. CONTENT CREATION
   ┌──────────────────────────────────────────────────────────────┐
   │                                                              │
   │   Developer                                                  │
   │       │                                                      │
   │       ├─── Manual Writing ──┐                                │
   │       │                     │                                │
   │       ├─── AI Assistant ────┤──▶ _posts/YYYY-MM-DD-*.md     │
   │       │    (Cursor/Claude)  │                                │
   │       │                     │                                │
   │       └─── News Draft ──────┘                                │
   │            (daily-news.yml)                                  │
   │                                                              │
   └──────────────────────────────────────────────────────────────┘
                              │
                              ▼
2. COMMIT & PUSH
   ┌──────────────────────────────────────────────────────────────┐
   │                                                              │
   │   git add _posts/YYYY-MM-DD-*.md                             │
   │   git commit -m "Add: 포스트 제목"                            │
   │   git push origin main                                       │
   │                                                              │
   └──────────────────────────────────────────────────────────────┘
                              │
                              ▼
3. CI/CD TRIGGER (Parallel)
   ┌──────────────────────────────────────────────────────────────┐
   │                                                              │
   │   ┌─────────────┐  ┌─────────────┐  ┌─────────────┐         │
   │   │ jekyll.yml  │  │sns-share.yml│  │ buttondown  │         │
   │   │             │  │             │  │    .yml     │         │
   │   │ paths:      │  │ paths:      │  │ paths:      │         │
   │   │  _posts/**  │  │  _posts/**  │  │  _posts/**  │         │
   │   └──────┬──────┘  └──────┬──────┘  └──────┬──────┘         │
   │          │                │                │                 │
   │          ▼                ▼                ▼                 │
   │    Build+Deploy      SNS Share       Email Notify           │
   │                                                              │
   └──────────────────────────────────────────────────────────────┘
                              │
                              ▼
4. DEPLOYMENT
   ┌──────────────────────────────────────────────────────────────┐
   │                                                              │
   │   ┌─────────────┐           ┌─────────────┐                 │
   │   │   GitHub    │           │   Vercel    │                 │
   │   │   Pages     │           │             │                 │
   │   │             │           │ Auto-detect │                 │
   │   │ (from GH    │           │ (Webhook)   │                 │
   │   │  Actions)   │           │             │                 │
   │   └──────┬──────┘           └──────┬──────┘                 │
   │          │                         │                        │
   │          ▼                         ▼                        │
   │   twodragon0.github.io    tech.2twodragon.com              │
   │        (Backup)               (Primary)                     │
   │                                                              │
   └──────────────────────────────────────────────────────────────┘
```

### 뉴스 수집 흐름

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           NEWS COLLECTION FLOW                               │
└─────────────────────────────────────────────────────────────────────────────┘

1. SCHEDULE TRIGGER
   ┌──────────────────────────────────────────────────────────────┐
   │                                                              │
   │   daily-news.yml                                             │
   │   schedule: '0 0 * * *'  (KST 09:00)                        │
   │                                                              │
   └──────────────────────────────────────────────────────────────┘
                              │
                              ▼
2. COLLECTION
   ┌──────────────────────────────────────────────────────────────┐
   │                                                              │
   │   RSS Feeds (15+ sources)                                    │
   │   ├── Security Vendors (Jamf, Cloudflare, Snyk, HashiCorp)  │
   │   ├── Tech News (CNCF, AWS, GCP)                            │
   │   └── Security Advisories (KISA, CISA)                      │
   │                              │                               │
   │                              ▼                               │
   │   collect_tech_news.py                                       │
   │   └── _data/collected_news.json                              │
   │                                                              │
   └──────────────────────────────────────────────────────────────┘
                              │
                              ▼
3. DRAFT GENERATION
   ┌──────────────────────────────────────────────────────────────┐
   │                                                              │
   │   generate_news_draft.py --use-ai                           │
   │                              │                               │
   │                              ▼                               │
   │   Gemini API                                                 │
   │   └── AI-assisted summary generation                        │
   │                              │                               │
   │                              ▼                               │
   │   _drafts/*.md                                               │
   │                                                              │
   └──────────────────────────────────────────────────────────────┘
                              │
                              ▼
4. REVIEW & PUBLISH
   ┌──────────────────────────────────────────────────────────────┐
   │                                                              │
   │   Auto PR Creation                                           │
   │   └── drafts/daily-news-{run_number}                        │
   │                              │                               │
   │                              ▼                               │
   │   Manual Review                                              │
   │   ├── Content verification                                  │
   │   ├── Category/tag adjustment                               │
   │   └── Move to _posts/                                       │
   │                                                              │
   └──────────────────────────────────────────────────────────────┘
```

## 보안 아키텍처

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           SECURITY ARCHITECTURE                              │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│   SECRETS MANAGEMENT                                                        │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │                       GitHub Secrets                                 │   │
│   │                                                                      │   │
│   │   • GEMINI_API_KEY        • TWITTER_*                               │   │
│   │   • SENTRY_AUTH_TOKEN     • FACEBOOK_*                              │   │
│   │   • BUTTONDOWN_API_KEY    • LINKEDIN_*                              │   │
│   │                                                                      │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│   ACCESS CONTROL                                                            │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │                                                                      │   │
│   │   Workflow Permissions (Least Privilege)                            │   │
│   │                                                                      │   │
│   │   • contents: read/write (as needed)                                │   │
│   │   • actions: read                                                   │   │
│   │   • pages: write (deploy only)                                      │   │
│   │   • pull-requests: write (PR creation)                              │   │
│   │                                                                      │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│   HTTP SECURITY HEADERS                                                     │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │                                                                      │   │
│   │   • Content-Security-Policy                                         │   │
│   │   • Strict-Transport-Security (HSTS)                                │   │
│   │   • X-Content-Type-Options: nosniff                                 │   │
│   │   • X-Frame-Options: DENY                                           │   │
│   │   • X-XSS-Protection                                                │   │
│   │                                                                      │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│   DEPENDENCY SECURITY                                                       │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │                                                                      │   │
│   │   • Dependabot auto-updates                                         │   │
│   │   • npm audit / bundle audit                                        │   │
│   │   • Regular security reviews                                        │   │
│   │                                                                      │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 비용 최적화

### Free Tier 최대 활용

| 서비스 | Free Tier 제한 | 최적화 전략 |
|--------|---------------|-------------|
| GitHub Actions | 2,000분/월 | 조건부 실행, 캐싱 |
| Vercel | 100GB 대역폭 | 이미지 최적화, CDN |
| Sentry | 5,000 이벤트/월 | 샘플링, 필터링 |
| Buttondown | 100 구독자 | - |
| Gemini API | Free Tier | 수동 실행만 |

### 비용 절감 팁

1. **조건부 실행**: paths-filter로 관련 파일 변경 시에만 실행
2. **캐싱**: Ruby, Node.js, Python 의존성 캐싱
3. **타임아웃**: 모든 워크플로우에 타임아웃 설정
4. **수동 트리거**: 비용이 많이 드는 워크플로우는 workflow_dispatch만

## 관련 문서

- [Workflows 상세](workflows.md)
- [Operations 가이드](operations.md)
- [PDCA 기능별 문서](../pdca/README.md)
