<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 700 520" font-family="system-ui, -apple-system, sans-serif">
  <defs>
    <linearGradient id="orangeGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" stop-color="#ea580c"/>
      <stop offset="100%" stop-color="#c2410c"/>
    </linearGradient>
    <linearGradient id="redGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" stop-color="#dc2626"/>
      <stop offset="100%" stop-color="#991b1b"/>
    </linearGradient>
    <marker id="arrow" viewBox="0 0 10 7" refX="10" refY="3.5" markerWidth="10" markerHeight="7" orient="auto-start-reverse">
      <polygon points="0 0, 10 3.5, 0 7" fill="#94a3b8"/>
    </marker>
    <filter id="shadow" x="-5%" y="-5%" width="115%" height="115%">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-color="#000" flood-opacity="0.4"/>
    </filter>
  </defs>

  <rect width="700" height="520" fill="#0d1117" rx="8"/>
  <text x="350" y="35" text-anchor="middle" fill="#f1f5f9" font-size="20" font-weight="bold">SolarWinds WHD Deserialization Attack</text>
  <text x="350" y="55" text-anchor="middle" fill="#64748b" font-size="12">Java Object Deserialization → Remote Code Execution (SYSTEM)</text>

  <!-- Step 1: Serialized Java Object -->
  <rect x="175" y="75" width="350" height="140" rx="10" fill="url(#orangeGrad)" filter="url(#shadow)"/>
  <text x="350" y="97" text-anchor="middle" fill="#fff7ed" font-size="11" font-weight="bold">STEP 1</text>
  <text x="350" y="116" text-anchor="middle" fill="#f1f5f9" font-size="15" font-weight="bold">Serialized Java Object</text>
  <!-- Inner box: Gadget Chain -->
  <rect x="200" y="130" width="300" height="32" rx="6" fill="#7c2d12" opacity="0.7"/>
  <text x="350" y="151" text-anchor="middle" fill="#fed7aa" font-size="12">Gadget Chain (Commons Collections / BeanUtils)</text>
  <!-- Inner box: Payload -->
  <rect x="200" y="170" width="300" height="32" rx="6" fill="#7c2d12" opacity="0.7"/>
  <text x="350" y="191" text-anchor="middle" fill="#fed7aa" font-size="12">Payload: Runtime.exec("cmd /c whoami")</text>

  <line x1="350" y1="215" x2="350" y2="250" stroke="#94a3b8" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- Step 2: HTTP Request -->
  <rect x="150" y="260" width="400" height="80" rx="10" fill="url(#orangeGrad)" filter="url(#shadow)"/>
  <text x="350" y="282" text-anchor="middle" fill="#fff7ed" font-size="11" font-weight="bold">STEP 2</text>
  <text x="350" y="301" text-anchor="middle" fill="#f1f5f9" font-size="15" font-weight="bold">HTTP POST Request</text>
  <text x="350" y="320" text-anchor="middle" fill="#fed7aa" font-size="11">/helpdesk/WebObjects/Helpdesk.woa</text>
  <text x="350" y="334" text-anchor="middle" fill="#fdba74" font-size="10">Content-Type: application/x-java-serialized-object</text>

  <line x1="350" y1="340" x2="350" y2="375" stroke="#94a3b8" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- Step 3: Server Execution -->
  <rect x="125" y="385" width="450" height="90" rx="10" fill="url(#redGrad)" filter="url(#shadow)"/>
  <text x="350" y="407" text-anchor="middle" fill="#fef2f2" font-size="11" font-weight="bold">STEP 3</text>
  <text x="350" y="426" text-anchor="middle" fill="#f1f5f9" font-size="15" font-weight="bold">Server-Side Deserialization</text>
  <text x="350" y="448" text-anchor="middle" fill="#fca5a5" font-size="12">ObjectInputStream.readObject() → Gadget Chain</text>
  <text x="350" y="465" text-anchor="middle" fill="#fca5a5" font-size="12">→ Runtime.exec() → Arbitrary Command (SYSTEM)</text>

  <!-- Impact badge -->
  <rect x="230" y="490" width="240" height="22" rx="11" fill="#7f1d1d" stroke="#ef4444" stroke-width="1"/>
  <text x="350" y="505" text-anchor="middle" fill="#fca5a5" font-size="11">CVSS 9.8 | No Authentication Required</text>
</svg>