<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 420" font-family="system-ui, -apple-system, sans-serif">
  <defs>
    <linearGradient id="redGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" stop-color="#dc2626"/>
      <stop offset="100%" stop-color="#991b1b"/>
    </linearGradient>
    <linearGradient id="darkRedGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" stop-color="#b91c1c"/>
      <stop offset="100%" stop-color="#7f1d1d"/>
    </linearGradient>
    <marker id="arrow" viewBox="0 0 10 7" refX="10" refY="3.5" markerWidth="10" markerHeight="7" orient="auto-start-reverse">
      <polygon points="0 0, 10 3.5, 0 7" fill="#94a3b8"/>
    </marker>
    <filter id="shadow" x="-5%" y="-5%" width="115%" height="115%">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-color="#000" flood-opacity="0.4"/>
    </filter>
  </defs>

  <rect width="800" height="420" fill="#0d1117" rx="8"/>
  <text x="400" y="32" text-anchor="middle" fill="#f1f5f9" font-size="18" font-weight="bold">NHI (Non-Human Identity) Attack Scenario</text>
  <text x="400" y="50" text-anchor="middle" fill="#64748b" font-size="11">Service Account &amp; API Key Compromise Chain</text>

  <!-- Quadrant 1: Initial Access (top-left) -->
  <rect x="30" y="70" width="350" height="130" rx="10" fill="url(#redGrad)" filter="url(#shadow)"/>
  <circle cx="55" cy="95" r="14" fill="#7f1d1d"/>
  <text x="55" y="100" text-anchor="middle" fill="#fef2f2" font-size="13" font-weight="bold">1</text>
  <text x="205" y="100" text-anchor="middle" fill="#f1f5f9" font-size="15" font-weight="bold">Initial Access</text>
  <text x="205" y="125" text-anchor="middle" fill="#fca5a5" font-size="12">Exposed API Keys</text>
  <text x="205" y="145" text-anchor="middle" fill="#fca5a5" font-size="11">(GitHub, Logs, Config Files)</text>
  <text x="205" y="170" text-anchor="middle" fill="#fca5a5" font-size="11">Docker images, Environment variables</text>

  <!-- Arrow 1→2 -->
  <line x1="380" y1="135" x2="415" y2="135" stroke="#94a3b8" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- Quadrant 2: Privilege Escalation (top-right) -->
  <rect x="425" y="70" width="350" height="130" rx="10" fill="url(#redGrad)" filter="url(#shadow)"/>
  <circle cx="450" cy="95" r="14" fill="#7f1d1d"/>
  <text x="450" y="100" text-anchor="middle" fill="#fef2f2" font-size="13" font-weight="bold">2</text>
  <text x="600" y="100" text-anchor="middle" fill="#f1f5f9" font-size="15" font-weight="bold">Privilege Escalation</text>
  <text x="600" y="125" text-anchor="middle" fill="#fca5a5" font-size="12">Over-privileged Service Account</text>
  <text x="600" y="145" text-anchor="middle" fill="#fca5a5" font-size="11">(Admin Role CI/CD Service Account)</text>
  <text x="600" y="170" text-anchor="middle" fill="#fca5a5" font-size="11">IAM PowerUser, Legacy tokens</text>

  <!-- Arrow 2→3 -->
  <line x1="600" y1="200" x2="600" y2="225" stroke="#94a3b8" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- Quadrant 3: Data Exfiltration (bottom-right) -->
  <rect x="425" y="235" width="350" height="130" rx="10" fill="url(#darkRedGrad)" filter="url(#shadow)"/>
  <circle cx="450" cy="260" r="14" fill="#450a0a"/>
  <text x="450" y="265" text-anchor="middle" fill="#fef2f2" font-size="13" font-weight="bold">3</text>
  <text x="600" y="265" text-anchor="middle" fill="#f1f5f9" font-size="15" font-weight="bold">Data Exfiltration</text>
  <text x="600" y="290" text-anchor="middle" fill="#fca5a5" font-size="12">S3 Buckets, Database Access</text>
  <text x="600" y="310" text-anchor="middle" fill="#fca5a5" font-size="11">Sensitive data extraction</text>
  <text x="600" y="330" text-anchor="middle" fill="#fca5a5" font-size="11">Log deletion for anti-forensics</text>

  <!-- Arrow 3→4 -->
  <line x1="425" y1="300" x2="390" y2="300" stroke="#94a3b8" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- Quadrant 4: Lateral Movement (bottom-left) -->
  <rect x="30" y="235" width="350" height="130" rx="10" fill="url(#darkRedGrad)" filter="url(#shadow)"/>
  <circle cx="55" cy="260" r="14" fill="#450a0a"/>
  <text x="55" y="265" text-anchor="middle" fill="#fef2f2" font-size="13" font-weight="bold">4</text>
  <text x="205" y="265" text-anchor="middle" fill="#f1f5f9" font-size="15" font-weight="bold">Lateral Movement</text>
  <text x="205" y="290" text-anchor="middle" fill="#fca5a5" font-size="12">Other Service Account Token Theft</text>
  <text x="205" y="310" text-anchor="middle" fill="#fca5a5" font-size="11">(SSRF, IMDS v1 Metadata)</text>
  <text x="205" y="330" text-anchor="middle" fill="#fca5a5" font-size="11">CI/CD pipeline token hijack</text>

  <!-- Key Attack Paths -->
  <rect x="150" y="385" width="500" height="24" rx="12" fill="#1e293b" stroke="#475569" stroke-width="1"/>
  <text x="400" y="401" text-anchor="middle" fill="#94a3b8" font-size="11">Key Vectors: Hardcoded Secrets | Over-privileged IAM | Non-expiring Tokens | IMDS v1</text>
</svg>