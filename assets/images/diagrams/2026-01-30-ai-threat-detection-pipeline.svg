<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 430" font-family="system-ui, -apple-system, sans-serif">
  <defs>
    <linearGradient id="blueGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" stop-color="#2563eb"/>
      <stop offset="100%" stop-color="#1d4ed8"/>
    </linearGradient>
    <linearGradient id="purpleGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" stop-color="#7c3aed"/>
      <stop offset="100%" stop-color="#5b21b6"/>
    </linearGradient>
    <linearGradient id="greenGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" stop-color="#16a34a"/>
      <stop offset="100%" stop-color="#15803d"/>
    </linearGradient>
    <marker id="arrow" viewBox="0 0 10 7" refX="10" refY="3.5" markerWidth="10" markerHeight="7" orient="auto-start-reverse">
      <polygon points="0 0, 10 3.5, 0 7" fill="#94a3b8"/>
    </marker>
    <filter id="shadow" x="-5%" y="-5%" width="115%" height="115%">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-color="#000" flood-opacity="0.4"/>
    </filter>
  </defs>

  <rect width="900" height="430" fill="#0d1117" rx="8"/>
  <text x="450" y="32" text-anchor="middle" fill="#f1f5f9" font-size="18" font-weight="bold">Microsoft AI Threat Detection Pipeline</text>

  <!-- Column headers -->
  <text x="130" y="62" text-anchor="middle" fill="#60a5fa" font-size="13" font-weight="bold">INPUT</text>
  <text x="450" y="62" text-anchor="middle" fill="#a78bfa" font-size="13" font-weight="bold">AI PROCESSING</text>
  <text x="780" y="62" text-anchor="middle" fill="#4ade80" font-size="13" font-weight="bold">OUTPUT</text>

  <!-- Left: Inputs -->
  <rect x="20" y="85" width="220" height="70" rx="10" fill="url(#blueGrad)" filter="url(#shadow)"/>
  <text x="130" y="113" text-anchor="middle" fill="#f1f5f9" font-size="13" font-weight="bold">Threat Reports</text>
  <text x="130" y="132" text-anchor="middle" fill="#bfdbfe" font-size="10">Hacker News, CISA, Vendors</text>

  <rect x="20" y="180" width="220" height="70" rx="10" fill="url(#blueGrad)" filter="url(#shadow)"/>
  <text x="130" y="208" text-anchor="middle" fill="#f1f5f9" font-size="13" font-weight="bold">Existing Detection Rules</text>
  <text x="130" y="227" text-anchor="middle" fill="#bfdbfe" font-size="10">Sentinel / Defender Rules</text>

  <rect x="20" y="275" width="220" height="70" rx="10" fill="url(#blueGrad)" filter="url(#shadow)"/>
  <text x="130" y="303" text-anchor="middle" fill="#f1f5f9" font-size="13" font-weight="bold">MITRE ATT&amp;CK Matrix</text>
  <text x="130" y="322" text-anchor="middle" fill="#bfdbfe" font-size="10">Tactics &amp; Techniques</text>

  <!-- Center: AI Processing -->
  <rect x="330" y="85" width="240" height="70" rx="10" fill="url(#purpleGrad)" filter="url(#shadow)"/>
  <text x="355" y="113" fill="#ede9fe" font-size="11" font-weight="bold">1</text>
  <text x="450" y="113" text-anchor="middle" fill="#f1f5f9" font-size="13" font-weight="bold">TTP Extraction</text>
  <text x="450" y="132" text-anchor="middle" fill="#c4b5fd" font-size="10">AI Engine</text>

  <rect x="330" y="180" width="240" height="70" rx="10" fill="url(#purpleGrad)" filter="url(#shadow)"/>
  <text x="355" y="208" fill="#ede9fe" font-size="11" font-weight="bold">2</text>
  <text x="450" y="208" text-anchor="middle" fill="#f1f5f9" font-size="13" font-weight="bold">Coverage Mapping</text>
  <text x="450" y="227" text-anchor="middle" fill="#c4b5fd" font-size="10">Mapping Engine</text>

  <rect x="330" y="275" width="240" height="70" rx="10" fill="url(#purpleGrad)" filter="url(#shadow)"/>
  <text x="355" y="303" fill="#ede9fe" font-size="11" font-weight="bold">3</text>
  <text x="450" y="303" text-anchor="middle" fill="#f1f5f9" font-size="13" font-weight="bold">Gap Identification</text>
  <text x="450" y="322" text-anchor="middle" fill="#c4b5fd" font-size="10">Analysis Engine</text>

  <!-- Right: Outputs -->
  <rect x="660" y="115" width="220" height="85" rx="10" fill="url(#greenGrad)" filter="url(#shadow)"/>
  <text x="770" y="148" text-anchor="middle" fill="#f1f5f9" font-size="13" font-weight="bold">Detection Rules</text>
  <text x="770" y="168" text-anchor="middle" fill="#bbf7d0" font-size="11">KQL / Sigma / YARA</text>
  <text x="770" y="186" text-anchor="middle" fill="#86efac" font-size="10">Auto-Generated</text>

  <rect x="660" y="230" width="220" height="85" rx="10" fill="url(#greenGrad)" filter="url(#shadow)"/>
  <text x="770" y="263" text-anchor="middle" fill="#f1f5f9" font-size="13" font-weight="bold">Coverage Gap Report</text>
  <text x="770" y="283" text-anchor="middle" fill="#bbf7d0" font-size="11">Prioritized Findings</text>
  <text x="770" y="301" text-anchor="middle" fill="#86efac" font-size="10">Actionable Insights</text>

  <!-- Arrows: Input → Processing -->
  <line x1="240" y1="120" x2="320" y2="120" stroke="#94a3b8" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="240" y1="215" x2="320" y2="215" stroke="#94a3b8" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="240" y1="310" x2="320" y2="310" stroke="#94a3b8" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- Arrows: Processing → Output -->
  <line x1="570" y1="120" x2="650" y2="155" stroke="#94a3b8" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="570" y1="215" x2="650" y2="170" stroke="#94a3b8" stroke-width="1.5" marker-end="url(#arrow)"/>
  <line x1="570" y1="215" x2="650" y2="260" stroke="#94a3b8" stroke-width="1.5" marker-end="url(#arrow)"/>
  <line x1="570" y1="310" x2="650" y2="275" stroke="#94a3b8" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- Source -->
  <text x="450" y="400" text-anchor="middle" fill="#475569" font-size="10">Source: Microsoft Security Research</text>
</svg>