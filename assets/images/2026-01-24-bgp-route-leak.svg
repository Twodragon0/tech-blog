<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 450">
  <defs>
    <linearGradient id="bgGrad2" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#0f172a"/>
      <stop offset="100%" style="stop-color:#1e293b"/>
    </linearGradient>
    <linearGradient id="cfGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#f97316"/>
      <stop offset="100%" style="stop-color:#fb923c"/>
    </linearGradient>
    <filter id="glow2">
      <feGaussianBlur stdDeviation="2" result="coloredBlur"/>
      <feMerge>
        <feMergeNode in="coloredBlur"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>
    <marker id="arrowGreen" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#22c55e"/>
    </marker>
    <marker id="arrowRed" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#ef4444"/>
    </marker>
  </defs>
  
  <!-- Background -->
  <rect width="800" height="450" fill="url(#bgGrad2)"/>
  
  <!-- Title -->
  <text x="400" y="35" font-family="system-ui, sans-serif" font-size="22" font-weight="700" fill="#f8fafc" text-anchor="middle">BGP Route Leak - How It Happens</text>
  
  <!-- Normal Flow Section -->
  <g transform="translate(30, 60)">
    <rect width="360" height="160" rx="12" fill="#1e293b" stroke="#22c55e" stroke-width="2"/>
    <text x="180" y="25" font-family="system-ui" font-size="14" font-weight="600" fill="#22c55e" text-anchor="middle">‚úÖ Normal BGP Route Propagation</text>
    
    <!-- Cloudflare -->
    <g transform="translate(30, 50)">
      <rect width="80" height="50" rx="8" fill="url(#cfGrad)"/>
      <text x="40" y="22" font-family="system-ui" font-size="10" font-weight="600" fill="#fff" text-anchor="middle">Cloudflare</text>
      <text x="40" y="38" font-family="system-ui" font-size="9" fill="#fff" text-anchor="middle">AS13335</text>
    </g>
    
    <!-- Transit Provider -->
    <g transform="translate(140, 50)">
      <rect width="80" height="50" rx="8" fill="#3b82f6"/>
      <text x="40" y="22" font-family="system-ui" font-size="10" font-weight="600" fill="#fff" text-anchor="middle">Transit</text>
      <text x="40" y="38" font-family="system-ui" font-size="9" fill="#bfdbfe" text-anchor="middle">Provider</text>
    </g>
    
    <!-- Other Networks -->
    <g transform="translate(250, 50)">
      <rect width="80" height="50" rx="8" fill="#6366f1"/>
      <text x="40" y="22" font-family="system-ui" font-size="10" font-weight="600" fill="#fff" text-anchor="middle">Other</text>
      <text x="40" y="38" font-family="system-ui" font-size="9" fill="#c7d2fe" text-anchor="middle">Networks</text>
    </g>
    
    <!-- Normal arrows -->
    <line x1="110" y1="75" x2="135" y2="75" stroke="#22c55e" stroke-width="2" marker-end="url(#arrowGreen)"/>
    <line x1="220" y1="75" x2="245" y2="75" stroke="#22c55e" stroke-width="2" marker-end="url(#arrowGreen)"/>
    
    <text x="180" y="130" font-family="system-ui" font-size="10" fill="#94a3b8" text-anchor="middle">Routes propagate through authorized paths</text>
    <text x="180" y="145" font-family="system-ui" font-size="10" fill="#4ade80" text-anchor="middle">Traffic flows correctly ‚úì</text>
  </g>
  
  <!-- Route Leak Section -->
  <g transform="translate(410, 60)">
    <rect width="360" height="160" rx="12" fill="#1e293b" stroke="#ef4444" stroke-width="2"/>
    <text x="180" y="25" font-family="system-ui" font-size="14" font-weight="600" fill="#ef4444" text-anchor="middle">‚ö†Ô∏è Route Leak Scenario</text>
    
    <!-- Cloudflare -->
    <g transform="translate(30, 50)">
      <rect width="70" height="45" rx="8" fill="url(#cfGrad)"/>
      <text x="35" y="20" font-family="system-ui" font-size="9" font-weight="600" fill="#fff" text-anchor="middle">Cloudflare</text>
      <text x="35" y="35" font-family="system-ui" font-size="8" fill="#fff" text-anchor="middle">AS13335</text>
    </g>
    
    <!-- Peer A (Leaker) -->
    <g transform="translate(130, 40)">
      <rect width="70" height="45" rx="8" fill="#ef4444"/>
      <text x="35" y="20" font-family="system-ui" font-size="9" font-weight="600" fill="#fff" text-anchor="middle">Peer A</text>
      <text x="35" y="35" font-family="system-ui" font-size="8" fill="#fecaca" text-anchor="middle">LEAKER</text>
    </g>
    
    <!-- Peer B -->
    <g transform="translate(230, 40)">
      <rect width="70" height="45" rx="8" fill="#f59e0b"/>
      <text x="35" y="20" font-family="system-ui" font-size="9" font-weight="600" fill="#fff" text-anchor="middle">Peer B</text>
      <text x="35" y="35" font-family="system-ui" font-size="8" fill="#fef3c7" text-anchor="middle">Affected</text>
    </g>
    
    <!-- Internet -->
    <g transform="translate(260, 95)">
      <ellipse cx="35" cy="20" rx="35" ry="20" fill="#475569"/>
      <text x="35" y="24" font-family="system-ui" font-size="9" fill="#e2e8f0" text-anchor="middle">Internet</text>
    </g>
    
    <!-- Leak arrows -->
    <line x1="100" y1="62" x2="125" y2="62" stroke="#ef4444" stroke-width="2" marker-end="url(#arrowRed)"/>
    <line x1="200" y1="62" x2="225" y2="62" stroke="#ef4444" stroke-width="2" marker-end="url(#arrowRed)"/>
    <path d="M200 85 Q230 120 260 105" stroke="#ef4444" stroke-width="2" fill="none" stroke-dasharray="4,2"/>
    
    <text x="180" y="135" font-family="system-ui" font-size="10" fill="#94a3b8" text-anchor="middle">Peer A incorrectly re-announces routes</text>
    <text x="180" y="150" font-family="system-ui" font-size="10" fill="#f87171" text-anchor="middle">Traffic misdirected/blocked ‚úó</text>
  </g>
  
  <!-- Timeline -->
  <g transform="translate(30, 240)">
    <text x="0" y="0" font-family="system-ui" font-size="14" font-weight="600" fill="#f8fafc">üìÖ Cloudflare Incident Timeline (Jan 22, 2026 UTC)</text>
    
    <line x1="0" y1="30" x2="740" y2="30" stroke="#334155" stroke-width="2"/>
    
    <!-- Timeline points -->
    <g transform="translate(0, 20)">
      <circle cx="50" cy="10" r="8" fill="#ef4444"/>
      <text x="50" y="35" font-family="system-ui" font-size="9" fill="#94a3b8" text-anchor="middle">14:23</text>
      <text x="50" y="48" font-family="system-ui" font-size="8" fill="#fca5a5" text-anchor="middle">Leak starts</text>
    </g>
    
    <g transform="translate(0, 20)">
      <circle cx="180" cy="10" r="8" fill="#f59e0b"/>
      <text x="180" y="35" font-family="system-ui" font-size="9" fill="#94a3b8" text-anchor="middle">14:25</text>
      <text x="180" y="48" font-family="system-ui" font-size="8" fill="#fcd34d" text-anchor="middle">Detected</text>
    </g>
    
    <g transform="translate(0, 20)">
      <circle cx="340" cy="10" r="8" fill="#3b82f6"/>
      <text x="340" y="35" font-family="system-ui" font-size="9" fill="#94a3b8" text-anchor="middle">14:28</text>
      <text x="340" y="48" font-family="system-ui" font-size="8" fill="#60a5fa" text-anchor="middle">Analysis</text>
    </g>
    
    <g transform="translate(0, 20)">
      <circle cx="500" cy="10" r="8" fill="#8b5cf6"/>
      <text x="500" y="35" font-family="system-ui" font-size="9" fill="#94a3b8" text-anchor="middle">14:35</text>
      <text x="500" y="48" font-family="system-ui" font-size="8" fill="#a78bfa" text-anchor="middle">Mitigation</text>
    </g>
    
    <g transform="translate(0, 20)">
      <circle cx="660" cy="10" r="8" fill="#22c55e"/>
      <text x="660" y="35" font-family="system-ui" font-size="9" fill="#94a3b8" text-anchor="middle">14:42</text>
      <text x="660" y="48" font-family="system-ui" font-size="8" fill="#4ade80" text-anchor="middle">Resolved</text>
    </g>
    
    <!-- Duration -->
    <rect x="280" y="65" width="180" height="25" rx="6" fill="#1e293b" stroke="#f59e0b"/>
    <text x="370" y="82" font-family="system-ui" font-size="11" font-weight="600" fill="#fcd34d" text-anchor="middle">Total Impact: ~19 minutes</text>
  </g>
  
  <!-- Protection Methods -->
  <g transform="translate(30, 360)">
    <text x="0" y="0" font-family="system-ui" font-size="14" font-weight="600" fill="#f8fafc">üõ°Ô∏è Protection Methods</text>
    
    <g transform="translate(0, 20)">
      <rect width="170" height="55" rx="8" fill="#1e293b" stroke="#22c55e"/>
      <text x="85" y="20" font-family="system-ui" font-size="10" font-weight="600" fill="#22c55e" text-anchor="middle">RPKI/ROA</text>
      <text x="85" y="35" font-family="system-ui" font-size="9" fill="#94a3b8" text-anchor="middle">Cryptographic origin</text>
      <text x="85" y="48" font-family="system-ui" font-size="9" fill="#94a3b8" text-anchor="middle">validation</text>
    </g>
    
    <g transform="translate(190, 20)">
      <rect width="170" height="55" rx="8" fill="#1e293b" stroke="#3b82f6"/>
      <text x="85" y="20" font-family="system-ui" font-size="10" font-weight="600" fill="#3b82f6" text-anchor="middle">IRR Filtering</text>
      <text x="85" y="35" font-family="system-ui" font-size="9" fill="#94a3b8" text-anchor="middle">Prefix-based access</text>
      <text x="85" y="48" font-family="system-ui" font-size="9" fill="#94a3b8" text-anchor="middle">control lists</text>
    </g>
    
    <g transform="translate(380, 20)">
      <rect width="170" height="55" rx="8" fill="#1e293b" stroke="#8b5cf6"/>
      <text x="85" y="20" font-family="system-ui" font-size="10" font-weight="600" fill="#8b5cf6" text-anchor="middle">BGP Communities</text>
      <text x="85" y="35" font-family="system-ui" font-size="9" fill="#94a3b8" text-anchor="middle">Route propagation</text>
      <text x="85" y="48" font-family="system-ui" font-size="9" fill="#94a3b8" text-anchor="middle">control signals</text>
    </g>
    
    <g transform="translate(570, 20)">
      <rect width="170" height="55" rx="8" fill="#1e293b" stroke="#f59e0b"/>
      <text x="85" y="20" font-family="system-ui" font-size="10" font-weight="600" fill="#f59e0b" text-anchor="middle">Real-time Monitoring</text>
      <text x="85" y="35" font-family="system-ui" font-size="9" fill="#94a3b8" text-anchor="middle">BGP anomaly</text>
      <text x="85" y="48" font-family="system-ui" font-size="9" fill="#94a3b8" text-anchor="middle">detection</text>
    </g>
  </g>
</svg>
