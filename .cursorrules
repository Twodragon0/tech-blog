# Cursor Rules for Tech Blog

## 프로젝트 개요
이 프로젝트는 Jekyll 기반의 기술 블로그입니다. DevSecOps, DevOps, FinOps 전문 콘텐츠를 다루며, 보안 중심의 실무 경험과 최신 트렌드를 공유합니다.

## 핵심 원칙

### 1. 보안 우선 (Security First)
- 모든 코드, 설정, 아키텍처 제안은 보안을 최우선으로 고려
- 최소 권한 원칙(Principle of Least Privilege) 적용
- Defense in Depth 전략 고려
- 민감한 정보(API 키, 비밀번호, 토큰 등)는 절대 하드코딩하지 않음
- 보안 모범 사례를 항상 제안

### 2. 실무 중심 (Practical Focus)
- 이론보다 실무 경험과 실제 사용 사례 중심
- 구체적인 코드 예제와 설정 파일 제공
- 문제 해결 과정과 트러블슈팅 포함
- 실제 운영 환경에서의 고려사항 언급

### 3. 구조화된 문서 (Structured Documentation)
- 모든 포스트는 일관된 구조를 따름
- 명확한 섹션 구분과 계층 구조
- 코드 블록은 적절한 언어 태그 사용
- 이미지와 다이어그램을 활용한 시각화

## 포스트 작성 규칙

### 파일명 형식
- 형식: `YYYY-MM-DD-제목.md`
- 예시: `2025-11-04-Zscaler_완벽_가이드_SSL_검사_샌드박스_AI_광고_유해_사이트_완벽_차단.md`
- 파일명은 영문과 언더스코어만 사용 (한글 제외)

### Front Matter (YAML 헤더)
모든 포스트는 다음 형식의 front matter를 포함해야 합니다:

```yaml
---
layout: post
title: "제목 (한글 가능)"
date: YYYY-MM-DD HH:MM:SS +0900
category: [카테고리]
categories: [카테고리1, 카테고리2]
tags: [태그1, 태그2, 태그3]
excerpt: "포스트 요약 (150-200자 권장)"
comments: true
original_url: https://twodragon.tistory.com/[번호]  # 선택사항
image: /assets/images/[파일명].svg
---
```

### 카테고리 목록
- `security`: 보안 관련 글
- `devsecops`: DevSecOps 관련
- `devops`: DevOps 관련
- `cloud`: 클라우드 관련
- `kubernetes`: Kubernetes 관련
- `finops`: FinOps 관련
- `incident`: 보안 사고 분석

### 포스트 구조
1. **Front Matter** (YAML 헤더)
2. **포스팅 요약** (구조화된 요약 박스)
   - 제목, 카테고리, 태그
   - 핵심 내용 (3-5개 bullet points)
   - 주요 기술/도구
   - 대상 독자
3. **서론** (배경 및 목적)
   - 문제 상황 설명
   - 해결 방법 개요
   - 포스팅의 목적
4. **본문** (주제별 섹션)
   - 명확한 제목과 계층 구조
   - 코드 예제 (필요시)
   - 이미지/다이어그램 (필요시)
   - 실무 팁 및 주의사항
   - 단계별 가이드 제공
5. **결론** (요약 및 다음 단계)
   - 핵심 내용 요약
   - 추가 학습 자료 (선택)
   - 원본 포스트 링크 (있는 경우)

### 포스팅 요약 형식
HTML 형식의 AI 요약 카드 사용 (권장, 기존 마크다운 형식도 허용):

```html
<div class="ai-summary-card">
<div class="ai-summary-header">
  <span class="ai-badge">AI 요약</span>
</div>
<div class="ai-summary-content">
  <div class="summary-row">
    <span class="summary-label">제목</span>
    <span class="summary-value">[제목]</span>
  </div>
  <div class="summary-row">
    <span class="summary-label">카테고리</span>
    <span class="summary-value"><span class="category-tag security">Security</span> <span class="category-tag cloud">Cloud</span></span>
  </div>
  <div class="summary-row">
    <span class="summary-label">태그</span>
    <span class="summary-value tags">
      <span class="tag">[태그1]</span>
      <span class="tag">[태그2]</span>
      <span class="tag">[태그3]</span>
    </span>
  </div>
  <div class="summary-row highlights">
    <span class="summary-label">핵심 내용</span>
    <ul class="summary-list">
      <li>[핵심 포인트 1]</li>
      <li>[핵심 포인트 2]</li>
      <li>[핵심 포인트 3]</li>
    </ul>
  </div>
  <div class="summary-row">
    <span class="summary-label">기술/도구</span>
    <span class="summary-value">[기술1, 기술2, 기술3]</span>
  </div>
  <div class="summary-row">
    <span class="summary-label">대상 독자</span>
    <span class="summary-value">[대상 독자]</span>
  </div>
</div>
<div class="ai-summary-footer">
  이 포스팅은 AI가 쉽게 이해하고 활용할 수 있도록 구조화된 요약을 포함합니다.
</div>
</div>
```

또는 마크다운 형식:
```markdown
## 📋 포스팅 요약

> **제목**: [제목]
> 
> **카테고리**: [카테고리]
> 
> **태그**: [태그1, 태그2, 태그3]
> 
> **핵심 내용**: 
> - [핵심 포인트 1]
> - [핵심 포인트 2]
> - [핵심 포인트 3]
> 
> **주요 기술/도구**: [기술1, 기술2, 기술3]
> 
> **대상 독자**: [대상 독자]
> 
> ---
> 
> *이 포스팅은 AI(Cursor, Claude 등)가 쉽게 이해하고 활용할 수 있도록 구조화된 요약을 포함합니다.*
```

## 코드 작성 규칙

### 코드 블록
- 언어 태그 필수: ````python`, ````bash`, ````yaml` 등
- 긴 코드는 핵심 부분만 보여주고 주석으로 생략 표시
- 보안 관련 코드는 민감 정보 제거 필수

### 코드 예제 모범 사례
```markdown
```bash
# 좋은 예: 설명이 포함된 명령어
aws ec2 describe-instances --filters "Name=tag:Name,Values=production-*"

# 나쁜 예: 민감한 정보 포함
aws ec2 describe-instances --region us-east-1 --profile my-secret-profile
```
```

### Terraform 코드
- 변수 사용 권장 (하드코딩 지양)
- 보안 그룹 규칙은 최소 권한 원칙 적용
- 리소스 태깅 규칙 준수
- 주석으로 보안 고려사항 설명

### YAML/JSON 설정
- 들여쓰기 일관성 유지 (스페이스 2칸)
- 주석으로 각 설정의 목적 설명
- 보안 관련 설정 강조

## 이미지 및 시각화

### 이미지 파일명 규칙
- **⚠️ 중요**: 모든 이미지 파일명은 반드시 영어로 작성해야 합니다
- 한글이 포함된 이미지 파일명은 사용하지 않음
- 파일명 형식: `YYYY-MM-DD-[영문_제목].svg` 또는 `.png`, `.jpg`
- 예시: `2025-06-05-Email_Delivery_Trust_Improve_SendGrid_SPF_DKIM_DMARC_Setup_Complete_Guide.svg`
- 한글 파일명이 발견되면 `scripts/rename_images_to_english.py` 스크립트를 사용하여 자동 변환

### 이미지 생성
- `GEMINI_IMAGE_GUIDE.md`와 `POST_VISUALIZATION_CHECKLIST.md` 참조
- nano banana 스타일 일러스트 사용
- 모든 이미지는 `/assets/images/` 디렉토리에 저장
- 파일명: `YYYY-MM-DD-[영문_포스트제목].svg` 또는 `.png`
- **한글 파일명 사용 금지**: 이미지 파일명에는 한글을 사용하지 않음

### 이미지 파일명 영어 변환
한글이 포함된 이미지 파일명을 영어로 변환하는 경우:

1. **자동 변환 스크립트 사용**:
   ```bash
   python3 scripts/rename_images_to_english.py
   # 또는 자동 확인 없이 실행
   python3 scripts/rename_images_to_english.py --yes
   ```

2. **변환 프로세스**:
   - 포스팅 파일의 `image:` 필드에서 이미지 파일명 확인
   - 한글 부분을 영어로 번역 (한글-영어 사전 사용)
   - 이미지 파일명 변경
   - 포스팅 파일의 모든 이미지 참조 자동 업데이트:
     - `image:` 필드
     - `<img src>` 태그
     - 마크다운 이미지 링크 `![...](...)`

3. **변환 후 검증**:
   - 모든 이미지 파일명이 영어로 변경되었는지 확인
   - 포스팅 파일의 이미지 경로 참조가 올바르게 업데이트되었는지 확인
   - 한글이 포함된 이미지 경로 참조가 없는지 확인

### 이미지 삽입 형식
```markdown
![이미지 설명](assets/images/[영문_파일명].svg)
*그림 1: 이미지 설명*
```

### SVG 이미지 텍스트 규칙
- **⚠️ 중요**: SVG 이미지 내의 모든 텍스트는 반드시 영어로만 작성해야 합니다
- 한글 텍스트는 인코딩 문제로 인해 깨질 수 있으므로 사용하지 않음
- SVG 파일의 `<text>` 요소에는 영어만 사용
- 제목, 라벨, 설명 등 모든 텍스트 요소를 영어로 작성
- 예시:
  - ❌ "클라우드 보안 과정" → ✅ "Cloud Security Course"
  - ❌ "보안 방어" → ✅ "Security Defense"
  - ❌ "정적 분석" → ✅ "Static Analysis"
  - ❌ "민감 정보 탐지" → ✅ "Sensitive Data Detection"
- SVG 생성 시 한글 텍스트가 포함되지 않도록 주의
- 기존 SVG 파일에 한글 텍스트가 있으면 영어로 변경

### 시각화 요소
- 아키텍처 다이어그램: 네트워크 구조, 시스템 구조
- 흐름도: 프로세스, 워크플로우
- 타임라인: 이벤트 순서, 장애 타임라인
- 비교표: Before/After, 솔루션 비교
- 차트: 데이터 시각화 (필요시)

## 보안 관련 작성 규칙

### 민감 정보 처리
- API 키, 비밀번호, 토큰은 절대 실제 값 사용 금지
- 예시: `YOUR_API_KEY`, `your-secret-key`, `***` 사용
- 환경 변수나 시크릿 관리 도구 사용 예시 제공
- 로그 파일에 민감 정보가 기록되지 않도록 주의
- API 키는 환경 변수로 관리: `export CLAUDE_API_KEY="your-key"`

### 민감 정보 마스킹 패턴
코드나 로그에서 민감 정보를 마스킹할 때 다음 패턴 사용:
- API 키: `sk-***MASKED***`, `AIza***MASKED***`
- 비밀번호: `***MASKED***`
- 토큰: `***TOKEN_MASKED***`
- 실제 IP 주소: 예시 IP 사용 (예: `192.0.2.0`)

### 보안 모범 사례 강조
- 코드 예제에 보안 주석 추가
- 취약점 및 대응 방법 명시
- 보안 체크리스트 제공 (필요시)
- Defense in Depth 전략 설명
- 최소 권한 원칙 적용 예시

### API 키 및 시크릿 관리
- 절대 Git에 커밋하지 않음
- `.gitignore`에 환경 변수 파일 포함
- AWS Secrets Manager, HashiCorp Vault 등 시크릿 관리 도구 사용
- 로컬 개발 시 `.env` 파일 사용 (Git 제외)

### 보안 경고 박스
```markdown
> **⚠️ 보안 주의사항**
> 
> [주의해야 할 보안 관련 내용]
> 
> - [주의사항 1]
> - [주의사항 2]
```

## 마크다운 작성 규칙

### 제목 계층
- `#` (H1): 포스트 제목 (front matter에서 처리)
- `##` (H2): 주요 섹션
- `###` (H3): 하위 섹션
- `####` (H4): 세부 항목 (최소한으로 사용)

### 리스트
- 순서 없는 리스트: `-` 사용
- 순서 있는 리스트: 숫자 사용
- 중첩 리스트는 2칸 들여쓰기

### 강조
- **굵게**: 중요한 개념, 키워드
- *기울임*: 강조 (최소한으로 사용)
- `코드`: 명령어, 파일명, 변수명

### 인용 블록
```markdown
> **💡 실무 팁**
> [팁 내용]

> **⚠️ 주의사항**
> [주의사항]

> **📌 핵심 요약**
> [요약 내용]
```

### 표
- 마크다운 표 형식 사용
- 헤더 행 명확히 구분
- 내용은 간결하고 읽기 쉽게

## 파일 구조 이해

### 디렉토리 구조
```
tech-blog/
├── _posts/          # 블로그 포스트 (Markdown)
├── _layouts/        # Jekyll 레이아웃 파일
├── _includes/        # 재사용 가능한 컴포넌트
├── assets/           # CSS, JS, 이미지 등 정적 파일
│   ├── css/
│   ├── js/
│   └── images/      # 포스트 이미지 저장
├── _config.yml       # Jekyll 설정 파일
├── Gemfile          # Ruby 의존성 관리
└── scripts/         # 유틸리티 스크립트
```

### 주요 파일
- `_config.yml`: 사이트 설정, 카테고리, 네비게이션
- `GEMINI_IMAGE_GUIDE.md`: 이미지 생성 가이드
- `POST_VISUALIZATION_CHECKLIST.md`: 시각화 체크리스트
- `README.md`: 프로젝트 개요

## 작업 시 주의사항

### 새 포스트 작성 시
1. `_posts/` 디렉토리에 올바른 파일명으로 생성
2. Front matter 형식 확인
3. 포스팅 요약 섹션 포함
4. 이미지 필요 시 `POST_VISUALIZATION_CHECKLIST.md` 참조
5. 코드 예제는 보안 고려사항 포함

### 기존 포스트 수정 시
1. Front matter 형식 유지
2. 기존 구조와 일관성 유지
3. 이미지 경로 확인 (영어 파일명 사용 확인)
4. **SVG 이미지 내 텍스트 확인 (영어로만 작성되어 있는지 확인)**
5. 링크 및 참조 확인
6. 한글 이미지 파일명이 있으면 `scripts/rename_images_to_english.py` 실행
7. SVG 이미지에 한글 텍스트가 있으면 영어로 변경

### 코드 변경 시
1. 보안 취약점 확인
2. 하드코딩된 민감 정보 제거
3. 주석으로 보안 고려사항 설명
4. 테스트 가능한 예제 제공

## AI 어시스턴트 활용 가이드

### 포스트 작성 요청 시
- 제목, 카테고리, 태그, 핵심 내용을 명확히 전달
- 필요한 이미지/다이어그램 요구사항 명시
- 대상 독자 레벨 지정
- 원본 URL이 있으면 `original_url` 필드에 포함

### 코드 작성 요청 시
- 사용 기술 스택 명시
- 보안 요구사항 명시
- 실행 환경 및 제약사항 명시
- 민감 정보는 환경 변수나 플레이스홀더 사용

### 이미지 생성 요청 시
- `GEMINI_IMAGE_GUIDE.md`의 템플릿 참조
- 스타일: nano banana
- 레이아웃: 가로형 (블로그 포스트용)
- **⚠️ 중요**: 이미지 파일명은 반드시 영어로 작성 (예: `2025-06-05-Email_Delivery_Trust_Improve_SendGrid_SPF_DKIM_DMARC_Setup_Complete_Guide.svg`)
- **⚠️ 중요**: SVG 이미지 내의 모든 텍스트는 영어로만 작성 (한글 텍스트 사용 금지)

## AI 프롬프트 엔지니어링

### 포스팅 개선 프롬프트 구조
AI 기반 포스팅 개선 시 다음 구조를 따릅니다:

```markdown
당신은 기술 블로그 전문 작가입니다. 다음 정보를 바탕으로 상세하고 실용적인 기술 블로그 포스팅 본문을 작성해주세요.

제목: [제목]
카테고리: [카테고리]
태그: [태그]
요약: [excerpt]
원본 URL: [original_url]

요구사항:
1. 실무 중심의 구체적인 내용으로 작성
2. 코드 예제와 설정 예시 포함
3. 보안 모범 사례 강조
4. 단계별 가이드 제공
5. 문제 해결 섹션 포함
6. 마크다운 형식으로 작성
7. 한글로 작성

다음 구조로 작성해주세요:
## 서론
[배경 및 목적 설명]

## 1. 개요
[주요 개념 및 배경]

## 2. 핵심 내용
[상세한 설명 및 실전 가이드]

## 3. 실전 적용
[구체적인 설정 방법 및 코드 예제]

## 4. 모범 사례
[보안 및 운영 모범 사례]

## 5. 문제 해결
[일반적인 문제 및 해결 방법]

## 결론
[요약 및 마무리]

원본 포스트: [original_url]
```

### 카테고리별 프롬프트 커스터마이징
- **보안 관련**: 보안 모범 사례, 위협 대응, 취약점 분석 강조
- **클라우드 관련**: 아키텍처 설계, 비용 최적화, 운영 모범 사례 강조
- **DevSecOps 관련**: CI/CD 통합, 자동화, 보안 스캔 통합 강조

### 포스팅 개선 기준
다음 조건을 만족하는 포스팅은 개선 대상입니다:
- 본문이 1500자 미만인 포스팅
- "서론" 또는 "1." 섹션이 없는 포스팅
- 원본 링크만 있고 본문이 거의 없는 포스팅

### AI 도구 활용 순서
1. **Claude API** (1순위): 가장 고품질의 콘텐츠 생성
2. **Gemini API** (2순위): Claude 실패 시 사용
3. **Cursor 분석** (3순위): API 키 없이도 작동, 파일 구조 분석 기반 개선

## 검증 체크리스트

### 포스트 작성 완료 후 확인
- [ ] Front matter 형식 올바름
- [ ] 포스팅 요약 섹션 포함 (HTML 또는 마크다운 형식)
- [ ] 이미지 경로 올바름 (`/assets/images/` 디렉토리)
- [ ] **이미지 파일명이 영어로 작성되었는지 확인** (한글 파일명 사용 금지)
- [ ] **SVG 이미지 내 텍스트가 영어로만 작성되었는지 확인** (한글 텍스트 사용 금지)
- [ ] 코드에 민감 정보 없음 (API 키, 비밀번호, 토큰)
- [ ] 보안 고려사항 명시
- [ ] 마크다운 형식 올바름
- [ ] 링크 및 참조 확인
- [ ] 한글/영문 혼용 일관성
- [ ] 서론 섹션 포함
- [ ] 본문 길이 1500자 이상 (권장)
- [ ] 원본 포스트 링크 포함 (있는 경우)

### 코드 검토 체크리스트
- [ ] 하드코딩된 민감 정보 제거
- [ ] 환경 변수 사용 예시 제공
- [ ] 보안 주석 포함
- [ ] 최소 권한 원칙 적용
- [ ] 에러 처리 포함

### AI 개선 후 검토
- [ ] 생성된 본문이 포스트 주제와 일치하는가?
- [ ] 코드 예제가 실제로 작동하는가?
- [ ] 보안 모범 사례가 포함되었는가?
- [ ] 실무 중심의 내용인가?
- [ ] 원본 포스트 링크가 유지되었는가?

## AI 기반 포스팅 개선 워크플로우

### 자동 개선 스크립트 활용
프로젝트에는 AI 기반 포스팅 개선 스크립트가 포함되어 있습니다:

1. **AI 기반 개선** (`scripts/ai_improve_posts.py`):
   - Claude API, Gemini API 활용
   - 실무 중심의 상세한 본문 생성
   - 카테고리별 맞춤 콘텐츠 생성

2. **기본 템플릿 개선** (`scripts/smart_improve_posts.py`):
   - API 키 없이도 작동
   - 기본 템플릿 기반 개선

### 개선 프로세스
1. 포스팅 분석: 본문 길이, 구조 확인
2. 개선 필요 여부 판단: 1500자 미만, 구조 부재 등
3. AI 콘텐츠 생성: Claude → Gemini → Cursor 분석 순서
4. 파일 업데이트: 기존 본문 교체 또는 추가
5. 로그 기록: 모든 작업은 `ai_improvement_log.txt`에 기록

### 실행 방법
```bash
# API 키 설정
./scripts/setup_ai_keys.sh

# 즉시 실행 (1시간)
./scripts/run_ai_improvement.sh

# 백그라운드 실행
./scripts/start_ai_background.sh

# 로그 확인
tail -f ai_improvement_log.txt
```

## 스크립트 및 자동화

### 주요 스크립트
- `scripts/ai_improve_posts.py`: AI 기반 포스팅 개선
- `scripts/enhance_all_posts.py`: 모든 포스팅 요약 섹션 보강
- `scripts/smart_improve_posts.py`: 지능형 포스팅 개선
- `scripts/fix_summary_format.py`: 요약 형식 표준화
- `scripts/rename_images_to_english.py`: 한글 이미지 파일명을 영어로 변환 및 포스팅 참조 업데이트

### 스크립트 작성 시 주의사항
- 모든 로그는 민감 정보 마스킹 필수
- API 키는 환경 변수에서만 읽기
- 예외 처리 시 민감 정보 포함 여부 확인
- 파일 작업 전 백업 권장

## 참고 문서
- `README.md`: 프로젝트 개요
- `BEST_PRACTICES.md`: 포스팅 작성 모범 사례
- `GEMINI_IMAGE_GUIDE.md`: 이미지 생성 가이드
- `POST_VISUALIZATION_CHECKLIST.md`: 시각화 체크리스트
- `scripts/README_AI_IMPROVEMENT.md`: AI 기반 개선 가이드
- `scripts/README_IMPROVEMENT.md`: 기본 개선 가이드
- `scripts/QUICK_START.md`: 빠른 시작 가이드
- `_config.yml`: Jekyll 설정 및 카테고리 목록
- `SECURITY.md`: 보안 정책

## 이미지 파일명 관리 규칙

### 핵심 원칙
1. **모든 이미지 파일명은 영어로 작성**: 한글 파일명 사용 금지
2. **일관된 파일명 형식**: `YYYY-MM-DD-[영문_제목].확장자`
3. **자동 변환 도구 사용**: 한글 파일명 발견 시 `scripts/rename_images_to_english.py` 사용

### 파일명 변환 프로세스
1. **포스팅 파일 분석**: 포스팅 파일의 `image:` 필드에서 이미지 파일명 확인
2. **한글-영어 번역**: 한글 부분을 영어로 번역 (내장 사전 사용)
3. **파일명 변경**: 이미지 파일명을 영어로 변경
4. **참조 업데이트**: 포스팅 파일의 모든 이미지 참조 자동 업데이트
   - Front matter의 `image:` 필드
   - HTML `<img src>` 태그
   - 마크다운 이미지 링크 `![...](...)`

### 사용되지 않는 스크립트 정리
- 중복 기능의 스크립트는 제거하여 유지보수성 향상
- `fix_all_duplicates.py`가 가장 포괄적이므로 중복 스크립트 제거
- 사용되지 않는 문서 파일도 정기적으로 정리
