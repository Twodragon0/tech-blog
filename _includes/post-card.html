{% assign post = include.post %}
<article class="post-card card">
  <a href="{{ post.url | relative_url }}" class="post-card-inner">
    {% if post.image %}
    <div class="post-card-image">
      <img src="{{ post.image | relative_url }}" alt="{{ post.title | escape }}" loading="lazy">
    </div>
    {% endif %}

    <div class="post-card-content">
      <div class="post-card-meta">
      {% comment %} Get category - prefer post.category, fallback to categories {% endcomment %}
      {% assign display_cat = nil %}
      {% if post.category and post.category != "" %}
        {% assign display_cat = post.category %}
      {% elsif post.categories %}
        {% assign categories_str = post.categories | join: "," %}
        {% if categories_str contains "," %}
          {% assign display_cat = post.categories | first %}
        {% else %}
          {% assign display_cat = post.categories %}
        {% endif %}
      {% endif %}

      {% if display_cat and display_cat != "" %}
      <span class="category-badge {{ display_cat | downcase | replace: ' ', '-' }}">{{ display_cat }}</span>
      {% endif %}
      <time datetime="{{ post.date | date_to_xmlschema }}">
        {{ post.date | date: "%Y. %m. %d" }}
      </time>
    </div>

    <h2 class="post-card-title">{{ post.title | escape }}</h2>

    {% if post.excerpt %}
    <p class="post-card-excerpt">{{ post.excerpt | strip_html | strip_newlines | truncate: 150 }}</p>
    {% endif %}

      {% if post.tags.size > 0 %}
      <div class="post-card-tags">
        {% for tag in post.tags limit:3 %}
        <span class="tag">{{ tag }}</span>
        {% endfor %}
      </div>
      {% endif %}
    </div>
  </a>
</article>
