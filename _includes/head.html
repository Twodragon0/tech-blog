<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Security Headers -->
  <!-- Note: X-Frame-OptionsëŠ” HTTP í—¤ë”ë¡œë§Œ ì„¤ì • ê°€ëŠ¥í•˜ë¯€ë¡œ ë©”íƒ€ íƒœê·¸ì—ì„œ ì œê±°ë¨ -->
  <!-- ì„œë²„ ì„¤ì •ì—ì„œ X-Frame-Options: SAMEORIGIN í—¤ë”ë¥¼ ì¶”ê°€í•´ì•¼ í•©ë‹ˆë‹¤ -->
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://giscus.app https://va.vercel-scripts.com https://pagead2.googlesyndication.com https://www.googletagmanager.com https://ep1.adtrafficquality.google https://ep2.adtrafficquality.google https://*.adtrafficquality.google; style-src 'self' 'unsafe-inline' https://giscus.app; img-src 'self' data: https:; font-src 'self'; frame-src https://giscus.app https://googleads.g.doubleclick.net https://tpc.googlesyndication.com; connect-src 'self' https://giscus.app https://api.mymemory.translated.net https://va.vercel-scripts.com https://vitals.vercel-insights.com https://googleads.g.doubleclick.net https://pagead2.googlesyndication.com https://www.googletagmanager.com https://ep1.adtrafficquality.google https://ep2.adtrafficquality.google https://*.adtrafficquality.google;">
  <meta http-equiv="X-Content-Type-Options" content="nosniff">
  <meta name="referrer" content="strict-origin-when-cross-origin">

  <!-- SEO -->
  <title>{% if page.title %}{{ page.title | escape }} | {{ site.title }}{% else %}{{ site.title }}{% endif %}</title>
  <meta name="description" content="{% if page.excerpt %}{{ page.excerpt | strip_html | strip_newlines | truncate: 160 }}{% elsif page.description %}{{ page.description }}{% else %}{{ site.description }}{% endif %}">
  <meta name="author" content="{{ site.author.name }}">
  <link rel="canonical" href="{{ page.url | absolute_url }}">

  <!-- Open Graph -->
  <meta property="og:title" content="{% if page.title %}{{ page.title | escape }}{% else %}{{ site.title }}{% endif %}">
  <meta property="og:description" content="{% if page.excerpt %}{{ page.excerpt | strip_html | strip_newlines | truncate: 160 }}{% elsif page.description %}{{ page.description }}{% else %}{{ site.description }}{% endif %}">
  <meta property="og:url" content="{{ page.url | absolute_url }}">
  <meta property="og:site_name" content="{{ site.title }}">
  <meta property="og:type" content="{% if page.layout == 'post' %}article{% else %}website{% endif %}">
  <meta property="og:locale" content="ko_KR">
  {% if page.layout == 'post' %}
  <meta property="article:author" content="{{ site.author.name }}">
  <meta property="article:published_time" content="{{ page.date | date_to_xmlschema }}">
  {% if page.date != page.last_modified_at %}
  <meta property="article:modified_time" content="{{ page.last_modified_at | date_to_xmlschema }}">
  {% endif %}
  {% if page.category %}
  <meta property="article:section" content="{{ page.category }}">
  {% endif %}
  {% if page.tags %}
  {% for tag in page.tags %}
  <meta property="article:tag" content="{{ tag }}">
  {% endfor %}
  {% endif %}
  {% endif %}
  {% assign og_image = page.image | default: site.og_image | default: site.logo %}
  {% if og_image %}
  <meta property="og:image" content="{{ og_image | absolute_url }}">
  <meta property="og:image:secure_url" content="{{ og_image | absolute_url }}">
  <meta property="og:image:width" content="{{ site.og_image_width | default: 1200 }}">
  <meta property="og:image:height" content="{{ site.og_image_height | default: 630 }}">
  <meta property="og:image:type" content="image/png">
  <meta property="og:image:alt" content="{% if page.title %}{{ page.title | escape }}{% else %}{{ site.title }}{% endif %}">
  {% endif %}

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="{% if page.title %}{{ page.title | escape }}{% else %}{{ site.title }}{% endif %}">
  <meta name="twitter:description" content="{% if page.excerpt %}{{ page.excerpt | strip_html | strip_newlines | truncate: 160 }}{% elsif page.description %}{{ page.description }}{% else %}{{ site.description }}{% endif %}">
  {% if site.twitter.username %}
  <meta name="twitter:site" content="{{ site.twitter.username }}">
  <meta name="twitter:creator" content="{{ site.twitter.username }}">
  {% endif %}
  {% if og_image %}
  <meta name="twitter:image" content="{{ og_image | absolute_url }}">
  <meta name="twitter:image:alt" content="{% if page.title %}{{ page.title | escape }}{% else %}{{ site.title }}{% endif %}">
  {% endif %}

  <!-- KakaoTalk Sharing (uses Open Graph) -->
  <meta name="format-detection" content="telephone=no">

  <!-- Feeds -->
  <link rel="alternate" type="application/rss+xml" title="{{ site.title }}" href="{{ "/feed.xml" | relative_url }}">
  <link rel="alternate" type="application/atom+xml" title="{{ site.title }}" href="{{ "/feed.xml" | relative_url }}">

  <!-- Favicon - ê¸°ë³¸ SVG ì•„ì´ì½˜ ì‚¬ìš© (404 ì—ëŸ¬ ë°©ì§€) -->
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ”’</text></svg>">
  <script>
    // Favicon íŒŒì¼ì´ ìˆìœ¼ë©´ êµì²´, ì—†ìœ¼ë©´ ê¸°ë³¸ ì•„ì´ì½˜ ìœ ì§€
    (function() {
      const faviconPath = '{{ "/assets/images/favicon.png" | relative_url }}';
      const appleIconPath = '{{ "/assets/images/apple-touch-icon.png" | relative_url }}';
      
      // Favicon ì¡´ì¬ ì—¬ë¶€ í™•ì¸ í›„ êµì²´
      const img = new Image();
      img.onload = function() {
        const faviconLink = document.querySelector('link[rel="icon"]');
        if (faviconLink) {
          faviconLink.href = faviconPath;
          faviconLink.type = 'image/png';
        }
      };
      img.onerror = function() {
        // Faviconì´ ì—†ìœ¼ë©´ ê¸°ë³¸ SVG ì•„ì´ì½˜ ìœ ì§€ (ì´ë¯¸ ì„¤ì •ë¨)
      };
      img.src = faviconPath;
      
      // Apple touch icon ì¡´ì¬ ì—¬ë¶€ í™•ì¸ í›„ ì¶”ê°€
      const img2 = new Image();
      img2.onload = function() {
        let appleIconLink = document.querySelector('link[rel="apple-touch-icon"]');
        if (!appleIconLink) {
          appleIconLink = document.createElement('link');
          appleIconLink.rel = 'apple-touch-icon';
          document.head.appendChild(appleIconLink);
        }
        appleIconLink.href = appleIconPath;
      };
      img2.onerror = function() {
        // Apple touch iconì´ ì—†ìœ¼ë©´ ì¶”ê°€í•˜ì§€ ì•ŠìŒ
      };
      img2.src = appleIconPath;
    })();
  </script>

  <!-- Styles -->
  <link rel="stylesheet" href="{{ "/assets/css/main.css" | relative_url }}">

  <!-- Theme Detection -->
  <script>
    (function() {
      const theme = localStorage.getItem('theme') ||
        (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
      document.documentElement.setAttribute('data-theme', theme);
    })();
  </script>

  {% if site.google_analytics %}
  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id={{ site.google_analytics }}"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', '{{ site.google_analytics }}');
  </script>
  {% endif %}

  {% if site.google_adsense %}
  <!-- Google AdSense -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client={{ site.google_adsense }}" crossorigin="anonymous"></script>
  {% endif %}

  {% seo %}

  <!-- Vercel Analytics & Speed Insights -->
  <script defer src="https://va.vercel-scripts.com/v1/script.js"></script>
  <script defer src="https://va.vercel-scripts.com/v1/speed-insights/script.js"></script>
</head>
